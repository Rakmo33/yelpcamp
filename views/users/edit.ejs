<%- include("../partials/header.ejs") %>
<div class="row">
    <h1 style="text-align: center">Edit Information</h1>
    <div style="width: 35%; margin: 50px auto;">
        <form action="/users/<%= user._id %>?_method=PUT" method="POST" enctype="multipart/form-data">

            <div class="form-group">
                <label for="firstname">First Name *</label>
                <input class="form-control" value="<%= user.firstName %>" required id="firstname" type="text"
                    name="user[firstName]" placeholder="Tony">
            </div>
            <div class="form-group">
                <label for="lastname">Last Name *</label>
                <input class="form-control" value="<%= user.lastName %>" required id="lastname" type="text"
                    name="user[lastName]" placeholder="Stark">
            </div>


            <div class="form-group">
                <label for="email">Email *</label>
                <input class="form-control" value="<%= user.email %>" required id="email" type="text" name="user[email]"
                    placeholder="rdj3000@gmail.com">
            </div>
            <div class="form-group">
                <label for="image">Avatar</label>
                <input class="custom-file-input" title="upload new file" type="file" id="image" name="user[image]"
                    accept="image/*"  onchange="foo()">
            </div>
           
            <div class="preview">
                <div id="avatarImg">
                    <% if( user.avatar.public_id != "avatar-1577909_1280_pvmw0e" ) {%>
                        <img id="blah" src="<%=user.avatar.url %>" alt="your image" width="100" height="100" />
                        <button type="button" onclick="foo2()" >Delete?</button>
                        <input style="display: none;" type="checkbox" name="deleteImage" onchange="foo3()" class="imageDeleteCheckbox" id="imageAvatar"
                            value="<%= user.avatar.public_id %>">
                    <% } %>

                </div>
              
                <img id="newImg" style="display: none;" alt="your image" width="100" height="100" />
            </div>
            <div class="form-group">
                <label for="bio">Bio </label>
                <textarea class="form-control" id="bio" rows="3" name="user[bio]"
                    placeholder="Tell something about yourself..."><%= user.bio %></textarea>
            </div>
            <div class="form-group">
                <button class="btn btn-lg btn-primary btn-block">Submit</button>
            </div>
        </form>

        <script>
            function foo() {
                document.getElementById("newImg").style.display = "";
                document.getElementById("avatarImg").style.display = "none";

                var input = document.getElementById("image")
                var previewImg = document.querySelector("#newImg")
                var src = window.URL.createObjectURL(input.files[0]);
                previewImg.setAttribute("src",src);
            }

            function foo2(){
                document.querySelector("#imageAvatar").checked = true;
                document.getElementById("avatarImg").style.display = "none";
                
            }

            function foo3(){
                if(document.querySelector("#imageAvatar").checked)
                console.log("LOLLLL")
            }
            

        </script>


    </div>

</div>
<%- include("../partials/footer.ejs") %>